"use strict";(self.webpackChunkbiolabo_front=self.webpackChunkbiolabo_front||[]).push([[298],{7298:(Ze,T,d)=>{d.r(T),d.d(T,{OrderModule:()=>_e});var p=d(6895),_=d(6773),l=d(1764),c=d(805),x=d(7787),e=d(8256),b=d(5343),Z=d(6927),U=d(431),q=d(7160),S=d(5760),v=d(1740),y=d(2453),u=d(433),m=d(2336),C=d(1493),f=d(9764);function D(r,n){1&r&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Id"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Grupo"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Cod"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Servicio"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"fecha atendido"),e.qZA(),e.TgZ(11,"th"),e._uU(12,"Estado"),e.qZA()())}function Y(r,n){if(1&r&&(e.TgZ(0,"tr",19)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"td"),e._uU(13),e.qZA()()),2&r){const t=n.$implicit;e.Akn(null==(null==t.idServicio?null:t.idServicio.idServicio)?"color: red":""),e.xp6(2),e.Oqu(null==t.idServicio?null:t.idServicio.idServicio),e.xp6(2),e.Oqu(null==t.idServicio||null==t.idServicio.idSubGrupo?null:t.idServicio.idSubGrupo.nombre),e.xp6(2),e.Oqu(null==t.idServicio?null:t.idServicio.codExterno1),e.xp6(2),e.Oqu(null==t.idServicio?null:t.idServicio.nombre),e.xp6(2),e.Oqu(e.xi3(11,8,t.labFechaMuestra,"dd/MM/YYYY HH:mm")),e.xp6(3),e.Oqu(t.ordenEstado)}}const M=function(){return{width:"65vw"}};let P=(()=>{class r{constructor(t,o,i,a,s,h){this._orionService=t,this._bioOrdenService=o,this._sucursalService=i,this._personaService=a,this._bioService=s,this.messageService=h,this.orden={},this.nOrdenOrion="",this.identificacion="",this.servicios=[],this.allowSaveOrd=!0}ngOnInit(){this.init(),this._bioService.getAllBioServicios().subscribe(t=>this.servicios=t)}init(){this.allowSaveOrd=!0,this.orden={},this.orden.ordExt="",this.orden.idPaciente={},this.orden.idPaciente.idPersona={},this.orden.idPaciente.idEmpresa={},this.orden.idPaciente.idEmpresa.razonSocial="",this.orden.uidCreacion={}}buscarOrdenOrion(){""==this.nOrdenOrion||" "==this.nOrdenOrion||(this.init(),this._bioOrdenService.getOneOrdenByCodExt(this.nOrdenOrion).subscribe(t=>{if(204!=t.status)return this.allowSaveOrd=!1,void(this.orden=t.body);this._orionService.getOrden(this.nOrdenOrion).subscribe({next:o=>{console.log(o),this.ordenOrionInd=o.data,this.parserOrdBioToOrdOrion(this.ordenOrionInd),this.showInfo("Orden de Orion encontrada")},error:o=>{this.init(),this.showError(`No hay ninguna orden con No. ${this.nOrdenOrion}`)}})}))}parserOrdBioToOrdOrion(t){this.orden.ordExt=t.numero_orden,this.orden.bioOrdenOcupDetalleList=[],this._personaService.getPacienteByIdentificacionAndEmpresa(t.paciente.numero_identificacion,"PARTICULAR").subscribe({next:i=>{null==i?this._personaService.getPersonaByCi(t.paciente.numero_identificacion).subscribe(a=>{this.orden.idPaciente.idPersona=a,null==a&&this.parserPersonaOrionToPersonaBio(t),this.orden.idPaciente.idEmpresa=this.generateEmpresaDefault(),this.saveOrderOrion()}):this.orden.idPaciente=i},error:i=>this.showError(`Error en busqueda de Paciente ${i}`)}),this._sucursalService.getOneSucursal(t.sucursal_id).subscribe({next:i=>this.orden.idSucursal=i,error:i=>{this.allowSaveOrd=!1,this.showError(`No hay Sucursal con id : ${t.sucursal_id}`)}}),this.orden.fechaSolicitado=t.fecha_orden?l(t.fecha_orden).toDate():null,this.orden.uidCreacion.username="orion",this.orden.ordOrigen="Orion",this.orden.ordEstado="Pendiente",this.orden.categoria=t.categoria_id.toString();for(let i of t.examenes){let a={},s=this.servicios.filter(h=>h.nombre==i.nombre);a.idServicio=s.length?s[0]:null,null==a.idServicio&&(this.allowSaveOrd=!1,a.idServicio={},a.idServicio.nombre=i.nombre,a.idServicio.codExterno1=i.codigo),this.orden.bioOrdenOcupDetalleList.push(a),a.labFechaMuestra=i.fecha_toma_muestra?l(i.fecha_validacion).toDate():null,a.fechaEmision=new Date,a.ordenEstado=i.estado}this.allowSaveOrd||this.showWarning("No se guard\xf3 la orden, hay Servicios no creados")}parserPersonaOrionToPersonaBio(t){let o={};o.nombresCompletos=t.paciente.apellidos.concat(" ").concat(t.paciente.nombres),o.email=t.paciente.correo,o.persGeneroSexo=t.paciente.sexo,o.identificacion=t.paciente.numero_identificacion,o.tipoIdentificacion=t.paciente.tipo_identificacion.charAt(0),o.fechaNac=l(t.paciente.fecha_nacimiento).toDate();let i=x.c.separreitorDeNombres(o.nombresCompletos).split("@");o.apellido1=i[0],o.apellido2=i[1],o.nombre1=i[2],o.nombre2=i[3],o.persEstado="activo",this.orden.idPaciente.idPersona=o}generateEmpresaDefault(){return{idEmpresa:1,razonSocial:"PARTICULAR"}}saveOrderOrion(){return this.allowSaveOrd?this._bioOrdenService.saveOrder(this.orden).subscribe(t=>this.orden=t):null}showError(t){this.messageService.add({severity:"error",summary:"Orden no encontrada",detail:t})}showInfo(t){this.messageService.add({severity:"success",summary:"\xc9xito",detail:t})}showWarning(t){this.messageService.add({severity:"info",summary:"Advertencia",detail:t})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(b.U),e.Y36(Z.p),e.Y36(U.f),e.Y36(q.v),e.Y36(S.B),e.Y36(c.ez))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-bio-orden"]],features:[e._Bn([c.ez])],decls:72,vars:26,consts:[["position","top-right"],[1,"bg-teal-50","mx-3","my-2","border-round","p-4","shadow-2"],[1,"text-3xl","font-medium","mb-3"],[1,"font-medium","text-600","m-1"],[1,"grid","bg-teal-50","mx-1","my-2","border-round","p-3","shadow-2"],[1,"col-12","md:col-3"],[1,"mb-2"],["name","ordExt","pInputText","","title","Buscar por No. Orden de Orion","placeholder","No Orden de Orion","type","text",1,"text-md","w-full",3,"ngModel","blur","ngModelChange"],[1,"md:col-5"],["header","Buscar Persona",3,"modal","dismissableMask"],[1,"grid"],[1,"col-12",3,"showHeader"],[1,"col-6","md:col-3"],[1,"col-12","md:col-2"],[1,"col-12","md:col-4"],["scrollHeight","280px","styleClass","p-datatable-sm",3,"value","scrollable"],["dt5",""],["pTemplate","header"],["pTemplate","body"],[1,"fila"]],template:function(t,o){1&t&&(e._UZ(0,"p-toast",0),e.TgZ(1,"div",1)(2,"div",2),e._uU(3,"Crear \xd3rden desde Orion"),e.qZA(),e.TgZ(4,"div",3),e._uU(5,"P\xe1gina para consultar ordenes de orion"),e.qZA(),e._UZ(6,"hr")(7,"br"),e.TgZ(8,"div",4)(9,"div",5)(10,"h5",6),e._uU(11,"No Orden de Orion"),e.qZA(),e.TgZ(12,"input",7),e.NdJ("blur",function(){return o.buscarOrdenOrion()})("ngModelChange",function(a){return o.nOrdenOrion=a}),e.qZA()(),e._UZ(13,"div",8),e.qZA(),e._UZ(14,"p-dialog",9)(15,"br"),e.TgZ(16,"div",10)(17,"p-panel",11)(18,"div",10)(19,"strong",12),e._uU(20," Id orden: "),e.qZA(),e.TgZ(21,"div",12),e._uU(22),e.qZA(),e.TgZ(23,"strong",12),e._uU(24," Num Ord: "),e.qZA(),e.TgZ(25,"div",12),e._uU(26),e.qZA(),e.TgZ(27,"strong",12),e._uU(28," Fecha Solicitado: "),e.qZA(),e.TgZ(29,"div",12),e._uU(30),e.ALo(31,"date"),e.qZA(),e.TgZ(32,"strong",13),e._uU(33," Categoria: "),e.qZA(),e.TgZ(34,"div",14),e._uU(35),e.qZA(),e.TgZ(36,"strong",12),e._uU(37," Creado por: "),e.qZA(),e.TgZ(38,"div",12),e._uU(39),e.qZA(),e.TgZ(40,"strong",13),e._uU(41," Estado: "),e.qZA(),e.TgZ(42,"div",14),e._uU(43," - "),e.qZA()()()(),e._UZ(44,"br"),e.TgZ(45,"div",10)(46,"p-panel",11)(47,"div",10)(48,"strong",12),e._uU(49," Nombres completos: "),e.qZA(),e.TgZ(50,"div",12),e._uU(51),e.qZA(),e.TgZ(52,"strong",12),e._uU(53," Identificacion: "),e.qZA(),e.TgZ(54,"div",12),e._uU(55),e.qZA(),e.TgZ(56,"strong",12),e._uU(57," Fecha nacimiento: "),e.qZA(),e.TgZ(58,"div",12),e._uU(59),e.ALo(60,"date"),e.qZA(),e.TgZ(61,"strong",13),e._uU(62," Sexo: "),e.qZA(),e.TgZ(63,"div",14),e._uU(64),e.qZA()()()(),e._UZ(65,"br"),e.TgZ(66,"p-table",15,16),e.YNc(68,D,13,0,"ng-template",17),e.YNc(69,Y,14,11,"ng-template",18),e.qZA(),e._UZ(70,"br")(71,"br"),e.qZA()),2&t&&(e.xp6(12),e.Q6J("ngModel",o.nOrdenOrion),e.xp6(2),e.Akn(e.DdM(25,M)),e.Q6J("modal",!0)("dismissableMask",!0),e.xp6(3),e.Q6J("showHeader",!1),e.xp6(5),e.hij(" ",o.orden.idOrdenOcupacional," "),e.xp6(4),e.hij(" ",o.orden.ordExt," "),e.xp6(4),e.hij(" ",e.Dn7(31,18,o.orden.fechaSolicitado,"dd/MM/YYYY HH:mm:ss","UTC+14")," "),e.xp6(5),e.hij(" ",o.orden.categoria," "),e.xp6(4),e.hij(" ",o.orden.uidCreacion.username," "),e.xp6(7),e.Q6J("showHeader",!1),e.xp6(5),e.hij(" ",null==o.orden.idPaciente||null==o.orden.idPaciente.idPersona?null:o.orden.idPaciente.idPersona.nombresCompletos," "),e.xp6(4),e.hij(" ",null==o.orden.idPaciente||null==o.orden.idPaciente.idPersona?null:o.orden.idPaciente.idPersona.identificacion," "),e.xp6(4),e.hij(" ",e.xi3(60,22,null==o.orden.idPaciente||null==o.orden.idPaciente.idPersona?null:o.orden.idPaciente.idPersona.fechaNac,"dd/MM/YYYY")," "),e.xp6(5),e.hij(" ",null==o.orden.idPaciente||null==o.orden.idPaciente.idPersona?null:o.orden.idPaciente.idPersona.persGeneroSexo," "),e.xp6(2),e.Q6J("value",o.orden.bioOrdenOcupDetalleList)("scrollable",!0))},dependencies:[v.o,y.FN,c.jx,u.Fj,u.JJ,m.iA,C.V,u.On,f.s,p.uU]}),r})();var E=d(5226),g=d.n(E),O=d(5593),N=d(7254);function w(r,n){if(1&r&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&r){const t=n.$implicit;e.xp6(1),e.AsE("",t.name," - ",t.size," bytes")}}function F(r,n){if(1&r&&(e.TgZ(0,"ul"),e.YNc(1,w,2,2,"li",19),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.uploadedFiles)}}function B(r,n){if(1&r&&e.YNc(0,F,2,1,"ul",11),2&r){const t=e.oxw();e.Q6J("ngIf",t.uploadedFiles.length)}}function H(r,n){if(1&r&&(e.TgZ(0,"h4"),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij("",t.ordenesBio.length," registros cargados")}}function j(r,n){1&r&&(e.TgZ(0,"tr"),e._UZ(1,"th",20),e.TgZ(2,"th"),e._uU(3,"Sucursal"),e.qZA(),e.TgZ(4,"th"),e._uU(5,"Cliente"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Categoria"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Orden No"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Fecha orden"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Hora"),e.qZA(),e.TgZ(14,"th"),e._uU(15,"Identificaci\xf3n"),e.qZA(),e.TgZ(16,"th"),e._uU(17,"Paciente"),e.qZA(),e.TgZ(18,"th"),e._uU(19,"Sexo"),e.qZA(),e.TgZ(20,"th"),e._uU(21,"Fecha nacimiento"),e.qZA(),e.TgZ(22,"th"),e._uU(23,"-"),e.qZA()())}function J(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"tr",21)(1,"td"),e._UZ(2,"button",22),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"td"),e._uU(15),e.ALo(16,"date"),e.qZA(),e.TgZ(17,"td"),e._uU(18),e.qZA(),e.TgZ(19,"td"),e._uU(20),e.qZA(),e.TgZ(21,"td"),e._uU(22),e.qZA(),e.TgZ(23,"td"),e._uU(24),e.qZA(),e.TgZ(25,"td")(26,"button",23),e.NdJ("click",function(){const a=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.removeOrden(a))}),e.qZA()()()}if(2&r){const t=n.$implicit,o=n.expanded;e.xp6(2),e.Q6J("pRowToggler",t)("icon",o?"pi pi-chevron-down":"pi pi-chevron-right"),e.xp6(2),e.Oqu(t.idSucursal.nombre),e.xp6(2),e.Oqu(t.idPaciente.idEmpresa.razonSocial),e.xp6(2),e.Oqu(t.categoria),e.xp6(2),e.Oqu(t.ordExt),e.xp6(2),e.Oqu(e.xi3(13,12,t.fechaSolicitado,"yyyy-MM-dd")),e.xp6(3),e.Oqu(e.Dn7(16,15,t.fechaSolicitado,"HH:mm","UTC +14")),e.xp6(3),e.Oqu(t.idPaciente.idPersona.identificacion),e.xp6(2),e.Oqu(t.idPaciente.idPersona.nombresCompletos),e.xp6(2),e.Oqu(t.idPaciente.idPersona.persGeneroSexo),e.xp6(2),e.Oqu(t.idPaciente.idPersona.fechaNac)}}function L(r,n){1&r&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"C\xf3digo"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Ex\xe1men"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Fecha validaci\xf3n"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Usuario validaci\xf3n"),e.qZA(),e._UZ(9,"th",20),e.qZA())}function I(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"tr",21)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td")(10,"button",23),e.NdJ("click",function(){const a=e.CHM(t).$implicit,s=e.oxw().$implicit,h=e.oxw();return e.KtG(h.removeOrdenDetalle(s,a))}),e.qZA()()()}if(2&r){const t=n.$implicit;e.xp6(2),e.Oqu(t.idServicio.idServicio),e.xp6(2),e.Oqu(t.idServicio.nombre),e.xp6(2),e.Oqu(t.labFechaMuestra),e.xp6(2),e.Oqu(t.labUsuarioValidacion)}}function z(r,n){1&r&&(e.TgZ(0,"tr")(1,"td",28),e._uU(2,"No hay ordenes"),e.qZA()())}function Q(r,n){if(1&r&&(e.TgZ(0,"tr")(1,"td",24)(2,"div",25)(3,"p-table",26),e.YNc(4,L,10,0,"ng-template",13),e.YNc(5,I,11,4,"ng-template",14),e.YNc(6,z,3,0,"ng-template",27),e.qZA()()()()),2&r){const t=n.$implicit;e.xp6(3),e.Q6J("value",t.bioOrdenOcupDetalleList)("scrollable",!0)}}function G(r,n){1&r&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"No."),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Detalle"),e.qZA()())}function $(r,n){if(1&r&&(e.TgZ(0,"tr")(1,"td",29),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA()()),2&r){const t=n.$implicit,o=e.oxw();e.xp6(2),e.Oqu(o.errorsDeCarga.indexOf(t)+1),e.xp6(2),e.Oqu(t)}}let R=(()=>{class r{constructor(t,o){this.messageService=t,this._orderService=o,this.ordenesBio=[],this.uploadedFiles=[],this.errorsDeCarga=[]}ngOnInit(){}onUpload(t){for(let o of t.files)this.uploadedFiles.push(o);this.messageService.add({severity:"info",summary:"File Uploaded",detail:""})}subirArchivo(t){this.errorsDeCarga=[],this.ordenesBio=[];for(let o of t.files)this._orderService.uploadExcelOrder(o).subscribe({next:i=>{this.ordenesBio=i},error:i=>{this.errorsDeCarga=i.error.error.split(",")}})}removeOrden(t){this.ordenesBio.splice(this.ordenesBio.indexOf(t),1)}removeOrdenDetalle(t,o){let i=this.ordenesBio.indexOf(t),a=this.ordenesBio[i].bioOrdenOcupDetalleList.indexOf(o);this.ordenesBio[i].bioOrdenOcupDetalleList.splice(a,1),0==this.ordenesBio[i].bioOrdenOcupDetalleList.length&&this.removeOrden(this.ordenesBio[i])}saveOrdenes(){0!=this.ordenesBio.length?this._orderService.saveOrderMasiva(this.ordenesBio).subscribe({next:t=>{this.ordenesBio=t,g().fire("Guardado con \xe9xito!","","success")},error:t=>{g().fire({title:"Ocurri\xf3 un error!",html:`<details> <summary>Detalle:</summary>\n        <p style="font-size: 0.88rem"> ${t.error.error}</p></details>`,icon:"error"}),console.log(t)}}):g().fire({icon:"error",title:"Mensaje de error",text:"Por favor, cargue primero el excel"})}saveButtonOrdenesmasiva(){this.errorsDeCarga.length>0?g().fire({icon:"error",title:"Mensaje de error",text:"A\xfan hay errores de carga: "+this.errorsDeCarga.length}):g().fire({title:"\xbfEst\xe1 seguro de realizar la acci\xf3n?",icon:"question",showCancelButton:!0,confirmButtonText:"Guardar \xf3rdenes",cancelButtonText:"Cancelar"}).then(t=>{t.isConfirmed&&this.saveOrdenes()})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(c.ez),e.Y36(Z.p))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-create-order"]],features:[e._Bn([c.ez])],decls:32,vars:8,consts:[[1,"bg-teal-50","mx-3","my-2","border-round","p-4","shadow-2"],[1,"text-3xl","font-medium","text-900","mb-3"],[1,"font-medium","text-600","mb-1"],["href","./../../../../../assets/static/detalle-ordenes-por-examen-2022-08-22-08-02-28.xlsx"],[1,"grid"],[1,"col-10"],[1,"col-2"],["type","button","title"," Pacientes y \xf3rdenes se crean automaticamente",1,"btnCustomized","px-8","py-2",3,"click"],[2,"font-weight","bold"],["name","demo[]","chooseLabel","Elegir","uploadLabel","Cargar","cancelLabel","Cancelar","url","null","accept",".xlsx, .xls, .csv",3,"customUpload","uploadHandler","onUpload"],["pTemplate","content"],[4,"ngIf"],["styleClass","p-datatable-sm","dataKey","ordExt","responsiveLayout","scroll","scrollHeight","450px",3,"value","scrollable"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],[2,"height","30px"],["toggler","header",3,"header","toggleable","collapsed"],["styleClass","p-datatable-sm","responsiveLayout","scroll","scrollHeight","350px",3,"value"],[4,"ngFor","ngForOf"],[2,"width","4rem"],[1,"text-sm"],["type","button","pButton","","pRipple","",1,"p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","icon"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"p-button-rounded","p-button-text",3,"click"],["colspan","7"],[1,"p-3"],["styleClass","p-datatable-sm","dataKey","id","responsiveLayout","scroll","scrollHeight","350px",3,"value","scrollable"],["pTemplate","emptymessage"],["colspan","4"],["width","5%"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"Cargar \xf3rdenes"),e.qZA(),e.TgZ(3,"div",2),e._uU(4,"Subir excel de detalles de ordenes generado por Orion"),e.qZA(),e.TgZ(5,"div",2),e._uU(6,"Para descargar una plantilla de ejemplo "),e.TgZ(7,"a",3),e._uU(8,"click aqu\xed"),e.qZA()(),e.TgZ(9,"div",4),e._UZ(10,"div",5),e.TgZ(11,"div",6)(12,"button",7),e.NdJ("click",function(){return o.saveButtonOrdenesmasiva()}),e._uU(13,"Guardar"),e.qZA()()(),e.TgZ(14,"div",2),e._uU(15,"Se necesita que est\xe9 creado: "),e.TgZ(16,"span",8),e._uU(17," Usuarios, Empresas, Sucursales y Servicios "),e.qZA()(),e.TgZ(18,"p-fileUpload",9),e.NdJ("uploadHandler",function(a){return o.subirArchivo(a)})("onUpload",function(a){return o.onUpload(a)}),e.YNc(19,B,1,1,"ng-template",10),e.qZA(),e._UZ(20,"br")(21,"br"),e.YNc(22,H,2,1,"h4",11),e.TgZ(23,"p-table",12),e.YNc(24,j,24,0,"ng-template",13),e.YNc(25,J,27,19,"ng-template",14),e.YNc(26,Q,7,2,"ng-template",15),e.qZA(),e._UZ(27,"div",16),e.TgZ(28,"p-panel",17)(29,"p-table",18),e.YNc(30,G,5,0,"ng-template",13),e.YNc(31,$,5,2,"ng-template",14),e.qZA()()()),2&t&&(e.xp6(18),e.Q6J("customUpload",!0),e.xp6(4),e.Q6J("ngIf",o.ordenesBio.length>0),e.xp6(1),e.Q6J("value",o.ordenesBio)("scrollable",!0),e.xp6(5),e.MGl("header"," Hay ",(null==o.errorsDeCarga?null:o.errorsDeCarga.length)>0?null==o.errorsDeCarga?null:o.errorsDeCarga.length:0," errores"),e.Q6J("toggleable",!0)("collapsed",!0),e.xp6(1),e.Q6J("value",o.errorsDeCarga))},dependencies:[p.sg,p.O5,O.Hq,c.jx,N.p,m.iA,m.jB,f.s,p.uU]}),r})();var k=d(2210);function K(r,n){1&r&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Cod"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Servicio"),e.qZA()())}function X(r,n){if(1&r&&(e.TgZ(0,"tr",12)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA()()),2&r){const t=n.$implicit;e.xp6(2),e.Oqu(t.idServicio.idSubGrupo.nombre),e.xp6(2),e.Oqu(t.idServicio.nombre)}}let V=(()=>{class r{constructor(t){this._ordenService=t,this.displayClose=new e.vpe}closeDialog(){this.displayClose.emit(this.display)}ngOnInit(){}atenderOrdenCaja(){this.orderSelect.fechaLlegadaCentro=new Date,this.orderSelect.ordEstado="En centro",this._ordenService.updateOrder(this.orderSelect).subscribe(console.log),this.displayClose.emit(this.display)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(Z.p))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-modal-orden-info"]],inputs:{orderSelect:"orderSelect",display:"display"},outputs:{displayClose:"displayClose"},decls:28,vars:14,consts:[["header","Informaci\xf3n Orden",1,"p-dialog-sm",3,"modal","dismissableMask","visible","onHide","visibleChange"],[1,"grid"],[1,"col-12",3,"showHeader"],[1,"col-6","md:col-3"],[1,"col-12","md:col-2"],[1,"col-12","md:col-4"],[1,"col-12","flex","justify-content-center"],["pButton","","label","Atender","icon","pi pi-check","pRipple","","type","button","title","Atender",1,"p-button-sm","w-9",3,"click"],["scrollHeight","180px","styleClass","p-datatable-sm",3,"value","scrollable"],["dt5",""],["pTemplate","header"],["pTemplate","body"],[1,"fila"]],template:function(t,o){1&t&&(e.TgZ(0,"p-dialog",0),e.NdJ("onHide",function(){return o.closeDialog()})("visibleChange",function(a){return o.display=a}),e.TgZ(1,"div",1)(2,"p-panel",2)(3,"div",1)(4,"strong",3),e._uU(5," Id orden: "),e.qZA(),e.TgZ(6,"div",3),e._uU(7),e.qZA(),e.TgZ(8,"strong",3),e._uU(9," Ord Ext: "),e.qZA(),e.TgZ(10,"div",3),e._uU(11),e.qZA(),e.TgZ(12,"strong",3),e._uU(13," Fecha Solicitado: "),e.qZA(),e.TgZ(14,"div",3),e._uU(15),e.ALo(16,"date"),e.qZA(),e.TgZ(17,"strong",4),e._uU(18," Categoria: "),e.qZA(),e.TgZ(19,"div",5),e._uU(20),e.qZA(),e.TgZ(21,"div",6)(22,"button",7),e.NdJ("click",function(){return o.atenderOrdenCaja()}),e.qZA()()()()(),e.TgZ(23,"p-table",8,9),e.YNc(25,K,5,0,"ng-template",10),e.YNc(26,X,5,2,"ng-template",11),e.qZA(),e._UZ(27,"br"),e.qZA()),2&t&&(e.Q6J("modal",!0)("dismissableMask",!0)("visible",o.display),e.xp6(2),e.Q6J("showHeader",!1),e.xp6(5),e.hij(" ",o.orderSelect.idOrdenOcupacional," "),e.xp6(4),e.hij(" ",o.orderSelect.ordExt," "),e.xp6(4),e.hij(" ",e.Dn7(16,10,o.orderSelect.fechaSolicitado,"dd/MM/YYYY HH:mm:ss","UTC+14")," "),e.xp6(5),e.hij(" ",o.orderSelect.categoria," "),e.xp6(3),e.Q6J("value",o.orderSelect.bioOrdenOcupDetalleList)("scrollable",!0))},dependencies:[O.Hq,c.jx,m.iA,C.V,f.s,p.uU]}),r})();function W(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",20),e._uU(1),e.TgZ(2,"span",21),e._UZ(3,"i",22),e.TgZ(4,"input",23,24),e.NdJ("input",function(){e.CHM(t);const i=e.MAs(5);e.oxw();const a=e.MAs(25);return e.KtG(a.filterGlobal(i.value,"contains"))}),e.qZA()()()}if(2&r){const t=e.oxw();e.xp6(1),e.hij(" Cant: ",t.ordenesYesterday.length," ")}}function ee(r,n){1&r&&(e.TgZ(0,"tr")(1,"th",25),e._uU(2,"Nombre"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Info"),e.qZA(),e.TgZ(5,"th",26),e._uU(6,"Acci\xf3n"),e.qZA()())}function te(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"tr",27)(1,"td"),e._uU(2),e.TgZ(3,"span",28),e._uU(4),e.qZA()(),e.TgZ(5,"td"),e._uU(6),e._UZ(7,"br"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td")(11,"button",29),e.NdJ("click",function(){const a=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.showDialogOrden(a))}),e.qZA()()()}if(2&r){const t=n.$implicit;e.xp6(2),e.hij("",t.idPaciente.idPersona.nombresCompletos," - "),e.xp6(2),e.hij("",t.idPaciente.idPersona.identificacion," "),e.xp6(2),e.hij("",t.idPaciente.idEmpresa.razonSocial," "),e.xp6(2),e.hij(" ",e.Dn7(9,4,t.fechaSolicitado,"dd/MM/YY HH:mm","UTC +14")," ")}}function re(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",20),e._uU(1),e.TgZ(2,"span",21),e._UZ(3,"i",22),e.TgZ(4,"input",23,30),e.NdJ("input",function(){e.CHM(t);const i=e.MAs(5);e.oxw();const a=e.MAs(34);return e.KtG(a.filterGlobal(i.value,"contains"))}),e.qZA()()()}if(2&r){const t=e.oxw();e.xp6(1),e.hij(" Cant: ",t.ordenesToday.length," ")}}function oe(r,n){1&r&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Nombre"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Info"),e.qZA(),e.TgZ(5,"th",26),e._uU(6,"Acci\xf3n"),e.qZA()())}function ne(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"tr",27)(1,"td"),e._uU(2),e.TgZ(3,"span",28),e._uU(4),e.qZA()(),e.TgZ(5,"td"),e._uU(6),e._UZ(7,"br"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td")(11,"button",29),e.NdJ("click",function(){const a=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.showDialogOrden(a))}),e.qZA()()()}if(2&r){const t=n.$implicit;e.xp6(2),e.hij("",t.idPaciente.idPersona.nombresCompletos," - "),e.xp6(2),e.hij("",t.idPaciente.idPersona.identificacion," "),e.xp6(2),e.hij("",t.idPaciente.idEmpresa.razonSocial," "),e.xp6(2),e.hij(" ",e.Dn7(9,4,t.fechaSolicitado,"dd/MM/YY HH:mm","UTC -10")," ")}}function ie(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",20),e._uU(1),e.TgZ(2,"span",21),e._UZ(3,"i",22),e.TgZ(4,"input",23,31),e.NdJ("input",function(){e.CHM(t);const i=e.MAs(5);e.oxw();const a=e.MAs(43);return e.KtG(a.filterGlobal(i.value,"contains"))}),e.qZA()()()}if(2&r){const t=e.oxw();e.xp6(1),e.hij(" Cant: ",t.ordenesAtendidas.length," ")}}function ae(r,n){1&r&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Nombre"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Empresa"),e.qZA(),e.TgZ(5,"th",26),e._uU(6,"Acci\xf3n"),e.qZA()())}function de(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"tr",27)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e._UZ(5,"br"),e._uU(6),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"td")(9,"button",32),e.NdJ("click",function(){const a=e.CHM(t).$implicit,s=e.oxw();return e.KtG(s.generateHojaRuta(a))}),e.qZA()()()}if(2&r){const t=n.$implicit;e.xp6(2),e.Oqu(t.idPaciente.idPersona.nombresCompletos),e.xp6(2),e.hij("",t.idPaciente.idEmpresa.razonSocial," "),e.xp6(2),e.hij(" ",e.Dn7(7,3,t.fechaLlegadaCentro,"dd/MM/YY HH:mm:ss","UTC -10")," ")}}const A=function(){return["idPaciente.idPersona.nombresCompletos","idPaciente.idEmpresa.razonSocial","idPaciente.idPersona.identificacion"]},se=function(){return["idPaciente.idPersona.nombresCompletos","idPaciente.idEmpresa.razonSocial"]};let le=(()=>{class r{constructor(t,o){this._ordenService=t,this.orionService=o,this.ordenSeleccionada={},this.ordenesToday=[],this.ordenesYesterday=[],this.ordenesAtendidas=[],this.ordenOrionCount=0,this.empresasList=[],this.display=!1,this.selectedEmpresa=[]}ngOnInit(){this.ordenSeleccionada.idOrdenOcupacional=0,this.cargarTablasOrdenes(),this.orionService.getOrdenes().subscribe({next:t=>{this.ordenesOrion=t,console.log(this.ordenesOrion),this.ordenOrionCount=this.ordenesOrion.meta.total},error:t=>console.log(t)})}cargarTablasOrdenes(){this.getOrdenesParaHoy(),this.getOrdenesDiasAnteriores(),this.getOrdenesLlegadasCentro()}filtrarEmpresas(){this.empresasList=[...new Set(this.ordenesToday.concat(this.ordenesYesterday).map(t=>t.idPaciente.idEmpresa.razonSocial))],this.empresasList.push("--- TODAS LAS EMPRESAS ---"),this.empresasList=this.empresasList.sort()}clear(t){t.clear()}getOrdenesParaHoy(){const t={start:"fechaSolicitadoStart",valueStart:l().format("YYYY-MM-DD 00:00:00"),end:"fechaSolicitadoEnd",valueEnd:l().format("YYYY-MM-DD 23:59:59"),estado:"ordEstados",valueEstado:["Pendiente"]};this._ordenService.getAllOrdenes(t).subscribe({next:o=>{this.ordenesToday=o,this.filtrarEmpresas()},error:o=>console.log(o)})}getOrdenesDiasAnteriores(){const t={start:"fechaSolicitadoStart",valueStart:l().add(-7,"day").format("YYYY-MM-DD 00:00:00"),end:"fechaSolicitadoEnd",valueEnd:l().add(-1,"day").format("YYYY-MM-DD 23:59:59"),estado:"ordEstados",valueEstado:["Pendiente"]};this._ordenService.getAllOrdenes(t).subscribe({next:o=>{this.ordenesYesterday=o,this.filtrarEmpresas()},error:o=>console.log(o)})}getOrdenesLlegadasCentro(){const t={start:"fechaSolicitadoStart",valueStart:l().add(-7,"day").format("YYYY-MM-DD 00:00:00"),end:"fechaSolicitadoEnd",valueEnd:l().format("YYYY-MM-DD 23:59:59"),estado:"ordEstados",valueEstado:["En centro"]};this._ordenService.getAllOrdenes(t).subscribe({next:o=>{this.ordenesAtendidas=o,this.filtrarEmpresas()},error:o=>console.log(o)})}showDialogOrden(t){this.ordenSeleccionada=t,this.display=!this.display}closeDialog(t){this.display=!1,this.cargarTablasOrdenes()}generateHojaRuta(t){console.log(t)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(Z.p),e.Y36(b.U))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-dashboard-order"]],decls:52,vars:14,consts:[[1,"bg-teal-50","mx-3","my-2","border-round","p-4","shadow-2"],[1,"flex","align-items-start","flex-column","lg:justify-content-between","lg:flex-row"],[1,"font-medium","text-3xl","text-900"],[1,"flex","align-items-center","text-700","flex-wrap"],[1,"mr-5","flex","align-items-center","mt-3"],[1,"pi","pi-users","mr-2"],[1,"pi","pi-globe","mr-2"],["styleClass","w-full",3,"options","ngModel","ngModelChange"],[1,"grid"],[1,"col-12","lg:col-4"],[1,"p-3","h-full"],[1,"nameTable"],["scrollHeight","550px","responsiveLayout","scroll",3,"value","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["dt2",""],["dt3",""],[3,"display","orderSelect","displayClose"],[1,"flex"],[1,"p-input-icon-left","ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar",2,"font-size","75%",3,"input"],["tt",""],["width","60%"],["width","10%"],[1,"fila"],[2,"font-size","0.9em"],["pButton","","pRipple","","type","button","icon","pi pi-check","title","Registrar la llegada del paciente al centro",1,"p-button-rounded","p-button-text",3,"click"],["tt2",""],["tt3",""],["pButton","","pRipple","","type","button","icon","pi pi-map","title","Generar Hoja de ruta",1,"p-button-rounded","p-button-text",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"div",2),e._uU(4,"Tablero de \xf3rdenes"),e.qZA(),e.TgZ(5,"div",3)(6,"div",4),e._UZ(7,"i",5),e.TgZ(8,"span"),e._uU(9),e.qZA()(),e.TgZ(10,"div",4),e._UZ(11,"i",6),e.TgZ(12,"span"),e._uU(13,"Alborada - Matriz"),e.qZA()()()()(),e._UZ(14,"br")(15,"br"),e.TgZ(16,"p-dropdown",7),e.NdJ("ngModelChange",function(a){return o.selectedEmpresa=a}),e.qZA(),e._UZ(17,"br")(18,"br"),e.TgZ(19,"div",8)(20,"div",9)(21,"div",10)(22,"span",11),e._uU(23," Pendientes dias anteriores "),e.qZA(),e.TgZ(24,"p-table",12,13),e.YNc(26,W,6,1,"ng-template",14),e.YNc(27,ee,7,0,"ng-template",15),e.YNc(28,te,12,8,"ng-template",16),e.qZA()()(),e.TgZ(29,"div",9)(30,"div",10)(31,"span",11),e._uU(32," Por Hacer hoy "),e.qZA(),e.TgZ(33,"p-table",12,17),e.YNc(35,re,6,1,"ng-template",14),e.YNc(36,oe,7,0,"ng-template",15),e.YNc(37,ne,12,8,"ng-template",16),e.qZA()()(),e.TgZ(38,"div",9)(39,"div",10)(40,"span",11),e._uU(41," Atendido hoy "),e.qZA(),e.TgZ(42,"p-table",12,18),e.YNc(44,ie,6,1,"ng-template",14),e.YNc(45,ae,7,0,"ng-template",15),e.YNc(46,de,10,7,"ng-template",16),e.qZA()()(),e.TgZ(47,"app-modal-orden-info",19),e.NdJ("displayClose",function(a){return o.closeDialog(a)}),e.qZA()(),e._UZ(48,"br")(49,"br")(50,"br")(51,"br"),e.qZA()),2&t&&(e.xp6(9),e.hij("",o.ordenOrionCount," Ord. Orion para hoy"),e.xp6(7),e.Q6J("options",o.empresasList)("ngModel",o.selectedEmpresa),e.xp6(8),e.Q6J("value",o.ordenesYesterday)("globalFilterFields",e.DdM(11,A)),e.xp6(9),e.Q6J("value",o.ordenesToday)("globalFilterFields",e.DdM(12,A)),e.xp6(9),e.Q6J("value",o.ordenesAtendidas)("globalFilterFields",e.DdM(13,se)),e.xp6(5),e.Q6J("display",o.display)("orderSelect",o.ordenSeleccionada))},dependencies:[O.Hq,v.o,c.jx,u.JJ,m.iA,k.Lt,u.On,V,p.uU],styles:[".nameTable[_ngcontent-%COMP%]{font-size:85%;color:gray}tr[_ngcontent-%COMP%]{font-size:.75rem}"]}),r})();var ce=d(615);function pe(r,n){1&r&&e._UZ(0,"img",2),2&r&&e.Q6J("routerLink","/home")}let ue=(()=>{class r{constructor(){}ngOnInit(){this.items=[{label:"Dashboard",styleClass:"menucus",routerLink:["/orden/dashboard"]},{label:"Ordenes",styleClass:"menucus",items:[{label:"Cargar \xd3rdenes",icon:"pi pi-fw pi-upload",routerLink:["/orden/crear"]},{label:"Crear \xd3rdenes",icon:"pi pi-fw pi-book",routerLink:["/orden/ordenbio"]}]}]}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-navbar-order"]],decls:2,vars:1,consts:[["styleClass","bg-indigo-100 text-white",3,"model"],["pTemplate","start"],["id","logoNavbar","src","assets/img/logotipo.png","height","40",1,"mr-2",3,"routerLink"]],template:function(t,o){1&t&&(e.TgZ(0,"p-menubar",0),e.YNc(1,pe,1,1,"ng-template",1),e.qZA()),2&t&&e.Q6J("model",o.items)},dependencies:[_.rH,c.jx,ce.nm]}),r})();const me=[{path:"",component:(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-order"]],decls:2,vars:0,template:function(t,o){1&t&&e._UZ(0,"app-navbar-order")(1,"router-outlet")},dependencies:[_.lC,ue]}),r})(),children:[{path:"crear",component:R},{path:"dashboard",component:le},{path:"ordenbio",component:P},{path:"**",redirectTo:"dashboard"}]}];let ge=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[_.Bz.forChild(me),_.Bz]}),r})();var he=d(4796);let _e=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[p.ez,ge,he.m,u.u5,f.Q]}),r})()}}]);